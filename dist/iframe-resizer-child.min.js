window.IFrameResizer={onReady:null,create:(options={})=>{const IFrameResizerInstance=new IFrameResizer(options);if(typeof window.IFrameResizer.onReady==="function"){window.IFrameResizer.onReady(IFrameResizerInstance)}return IFrameResizerInstance}};class IFrameResizer{static instance;constructor(options={}){if(!IFrameResizer.hasParent()){console.log("Not running inside an iFrame. Initialization aborted.");return}else{console.log("Running inside an iFrame.")}if(IFrameResizer.instance){IFrameResizer.instance.destroy()}IFrameResizer.instance=this;this.lastHeight=null;const defaultOptions={targetOrigin:"*",resize:true,scroll:true,log:false};this.options={...defaultOptions,...options};this.observer=null;this.log("Initializing",this.options);if(this.options.resize){this.initResizeListener()}if(this.options.scroll){this.initScrollListener()}}initResizeListener(){this.onResize=this.onResize.bind(this);const targetNode=document.body;const config={attributes:true,childList:true,subtree:true,characterData:true};this.observer=new MutationObserver(()=>this.onResize());this.observer.observe(targetNode,config);this.onResize()}initScrollListener(){this.onScroll=this.onScroll.bind(this);window.addEventListener("scroll",this.onScroll)}onResize(force=false){const bodyHeight=document.body.scrollHeight;const htmlHeight=document.documentElement.scrollHeight;const offsetHeight=document.documentElement.offsetHeight;const newHeight=Math.max(bodyHeight,htmlHeight,offsetHeight);if(force||newHeight!==this.lastHeight){this.lastHeight=newHeight;this.sendMessage("resize",{height:newHeight})}}onScroll(){const top=window.scrollY||document.documentElement.scrollTop;const left=window.scrollX||document.documentElement.scrollLeft;this.sendMessage("scroll",{top:top,left:left})}sendMessage(type,data){this.log("postMessage",{type:type,...data});window.parent.postMessage({type:type,...data},this.options.targetOrigin)}log(message,data){if(this.options.log){console.log(`[LOG][IFRAME CHILD][${window.location.host}]: ${message}`,data)}}destroy(){this.log("Destroying IFrameResizer instance");if(this.options.resize){this.observer&&this.observer.disconnect()}if(this.options.scroll){window.removeEventListener("scroll",this.onScroll)}this.observer=null;this.lastHeight=null}static hasParent(){return window.self!==window.top}}